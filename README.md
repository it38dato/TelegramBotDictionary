<p># Разработка функции меню.<br># Применение библиотеки Translator.<br># Применение библиотеки Aiogram.<br># Администрирование баз данный.<br># Разработка базы данных.<br># Написание Sql запросов.<br># Применение библиотеки psycopg2.<br># Применение библиотеки Telebot.<br># Настройка службы бота.<br><strong>Task:</strong><br>Разработка функции меню.<br><strong>Decision:</strong><br>tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyMenu.py<br>tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyMenu.py<br>def fun(t1, b, t2, l, t3):<br>  while True:  <br>&nbsp;&nbsp;cmd1 = input("Привет!\nЯ тестовый бот.\nВыбери программу, которую ты хочешь выполнить\n(0, translator, dictionary): ")<br>&nbsp;&nbsp;if cmd1 == "0":<br>&nbsp;&nbsp;  break<br>&nbsp;&nbsp;elif cmd1 == t1:<br>&nbsp;&nbsp;  while True:<br>&nbsp;&nbsp;&nbsp;&nbsp;cmd2 = input("Что именно нужно сделать\n(translate, back): ")<br>&nbsp;&nbsp;&nbsp;&nbsp;if cmd2 == b:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print('Вы вернулись в главное меню')<br>&nbsp;&nbsp;&nbsp;&nbsp;  break<br>&nbsp;&nbsp;&nbsp;&nbsp;elif cmd2 == t2:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Здесь программа переведет вам текст")<br>&nbsp;&nbsp;&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Я такую команду не знаю")<br>&nbsp;&nbsp;elif cmd1 == "dictionary":<br>&nbsp;&nbsp;  while True:<br>&nbsp;&nbsp;&nbsp;&nbsp;cmd2 = input("Что именно нужно сделать\n(list,term,back): ")<br>&nbsp;&nbsp;&nbsp;&nbsp;if cmd2 == b:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print('Вы вернулись в главное меню')<br>&nbsp;&nbsp;&nbsp;&nbsp;  break<br>&nbsp;&nbsp;&nbsp;&nbsp;elif cmd2 == l:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Вывести список слов")<br>&nbsp;&nbsp;&nbsp;&nbsp;elif cmd2 == t3:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Выбрать слово их списка")<br>&nbsp;&nbsp;&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Я такую команду не знаю")<br>&nbsp;&nbsp;else:<br>&nbsp;&nbsp;  print("Я такую команду не знаю")<br>  return t1<br>print(fun("translator","back","translate","list","term"))<br>tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyMenu.py<br>Привет!<br>Я тестовый бот.<br>Выбери программу, которую ты хочешь выполнить<br>(0, translator, dictionary): translator<br>Что именно нужно сделать<br>(translate, back): translate <br>Здесь программа переведет вам текст<br>Что именно нужно сделать<br>(translate, back): back<br>Вы вернулись в главное меню<br>Привет!<br>Я тестовый бот.<br>Выбери программу, которую ты хочешь выполнить<br>(0, translator, dictionary): dictionary<br>Что именно нужно сделать<br>(list,term,back): list<br>Вывести список слов<br>Что именно нужно сделать<br>(list,term,back): term<br>Выбрать слово их списка<br>Что именно нужно сделать<br>(list,term,back): back<br>Вы вернулись в главное меню<br>Привет!<br>Я тестовый бот.<br>Выбери программу, которую ты хочешь выполнить<br>(0, translator, dictionary): 0<br>translator<br><strong>Task:</strong><br>Подготовка библиотек.<br><strong>Decision:</strong><br>tuser@kvmubuntu:~/TelegramBotTranslator$ python3 -m venv tenv<br>tuser@kvmubuntu:~/TelegramBotTranslator$ source tenv/bin/activate<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim requirements.txt<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat requirements.txt<br>translate==3.6.1<br>pyTelegramBotAPI==4.21.0<br>googletrans==3.1.0a0<br>langdetect==1.0.9<br>aiogram==2.23.1<br>psycopg2-binary==2.9.9<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ pip install -r requirements.txt<br><strong>Task:</strong><br>Раработка программы переводчик.<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyTranslator.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyTranslator.py<br>from translate import Translator<br>translator=Translator(from_lang="russian", to_lang="english")<br>translation=translator.translate("Вчера я забронировал у вас номер в отеле.")<br>print(translation)<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 translator.py<br>Hi, how are you?<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyTranslator1.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyTranslator1.py<br>from translate import Translator<br>ru_letters = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя"<br>en_letters = "abcdefghijklmnopqrstuvwxyz"<br>cmd3 = input("Введите текст, который вы хотите перевести: ")<br>if cmd3[0].lower() in ru_letters:<br>&nbsp;&nbsp;translator = Translator(from_lang="russian", to_lang="english")<br>elif cmd3[0].lower() in en_letters:<br>&nbsp;&nbsp;translator = Translator(from_lang="english", to_lang="russian")<br>else:<br>&nbsp;&nbsp;print('Я тебя не понимаю')<br>translation = translator.translate(cmd3)<br>print(translation)<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyTranslator1.py<br>Введите текст, который вы хотите перевести: Вчера я забронировал у вас номер в отеле.<br>Tom booked a room at the hotel<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyTranslator2.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyTranslator2.py<br>from googletrans import Translator<br>from langdetect import detect<br>translator = Translator()<br>cmd3 = input("Введите текст, который вы хотите перевести: ")<br>translation = translator.translate(cmd3, src=detect(cmd3), dest='en').text<br>print(translation.encode('utf-8', 'replace').decode())<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyTranslator2.py<br>Введите текст, который вы хотите перевести: Вчера я забронировал у вас номер в отеле.<br>Yesterday I booked a hotel room with you.<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyTranslator3.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyTranslator3.py<br>from googletrans import Translator<br>from langdetect import detect<br>translator = Translator()<br>cmd3 = input("Введите текст, который вы хотите перевести: ")<br>ru_letters = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя"<br>en_letters = "abcdefghijklmnopqrstuvwxyz"<br>if cmd3[0].lower() in ru_letters:<br>&nbsp;&nbsp;translation = translator.translate(cmd3, src=detect(cmd3), dest='en').text<br>&nbsp;&nbsp;print(translation.encode('utf-8', 'replace').decode())<br>elif cmd3[0].lower() in en_letters:<br>&nbsp;&nbsp;translation = translator.translate(cmd3, src=detect(cmd3), dest='ru').text<br>&nbsp;&nbsp;print(translation.encode('utf-8', 'replace').decode())<br>else:<br>&nbsp;&nbsp;print('Я тебя не понимаю')<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyTranslator3.py<br>Введите текст, который вы хотите перевести: Для тестирования работоспособности телеграм бота переводчик, написанном на Python мы использовали готовый преднастроенный телеграм бот сервер.<br>To test the functionality of the telegram bot translator, written in Python, we used a ready-made pre-configured telegram bot server.<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyTranslator3.py<br>Введите текст, который вы хотите перевести: To test the functionality of the telegram bot translator, written in Python, we used a ready-made pre-configured telegram bot server.<br>Для проверки работоспособности переводчика телеграмм-бота, написанного на Python, мы использовали готовый, предварительно настроенный сервер телеграм-бота.<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyTranslator3.py<br>Введите текст, который вы хотите перевести: ;<br>Я тебя не понимаю<br><strong>Task:</strong><br>Применение библиотеки Translator и готовой функции меню. <br><strong>Decision:</strong><br>(tenv) root@kvmubuntu:~# vim pyMenuTranslator.py<br>(tenv) root@kvmubuntu:~# cat pyMenuTranslator.py<br>from translate import Translator<br>def fun(t1, b, t2, l, t3):<br>  while True:  <br>&nbsp;&nbsp;cmd1 = input("Привет!\nЯ тестовый бот.\nВыбери программу, которую ты хочешь выполнить\n(0, translator, dictionary): ")<br>&nbsp;&nbsp;if cmd1 == "0":<br>&nbsp;&nbsp;  break<br>&nbsp;&nbsp;elif cmd1 == t1:<br>&nbsp;&nbsp;  while True:<br>&nbsp;&nbsp;&nbsp;&nbsp;cmd2 = input("Что именно нужно сделать\n(translate, back): ")<br>&nbsp;&nbsp;&nbsp;&nbsp;if cmd2 == b:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print('Вы вернулись в главное меню')<br>&nbsp;&nbsp;&nbsp;&nbsp;  break<br>&nbsp;&nbsp;&nbsp;&nbsp;elif cmd2 == t2:<br>&nbsp;&nbsp;&nbsp;&nbsp;  cmd3 = input("Введите текст, который вы хотите перевести: ")<br>&nbsp;&nbsp;&nbsp;&nbsp;  t4=Translator(from_lang="russian", to_lang="english")<br>&nbsp;&nbsp;&nbsp;&nbsp;  translation=t4.translate(cmd3)<br>&nbsp;&nbsp;&nbsp;&nbsp;  print(translation)<br>&nbsp;&nbsp;&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Я такую команду не знаю")<br>&nbsp;&nbsp;elif cmd1 == "dictionary":<br>&nbsp;&nbsp;  while True:<br>&nbsp;&nbsp;&nbsp;&nbsp;cmd2 = input("Что именно нужно сделать\n(list,term,back): ")<br>&nbsp;&nbsp;&nbsp;&nbsp;if cmd2 == b:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print('Вы вернулись в главное меню')<br>&nbsp;&nbsp;&nbsp;&nbsp;  break<br>&nbsp;&nbsp;&nbsp;&nbsp;elif cmd2 == l:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Вывести список слов")<br>&nbsp;&nbsp;&nbsp;&nbsp;elif cmd2 == t3:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Выбрать слово их списка")<br>&nbsp;&nbsp;&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;  print("Я такую команду не знаю")<br>&nbsp;&nbsp;else:<br>&nbsp;&nbsp;  print("Я такую команду не знаю")<br>  return t1<br>print(fun("translator","back","translate","list","term"))<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyMenuTranslator.py<br>Привет!<br>Я тестовый бот.<br>Выбери программу, которую ты хочешь выполнить<br>(0, translator, dictionary): translator<br>Что именно нужно сделать<br>(translate, back): translate <br>Введите текст, который вы хотите перевести: Привет. Как дела?<br>Hi, how are you?<br>Что именно нужно сделать<br>(translate, back): back   <br>Вы вернулись в главное меню<br>Привет!<br>Я тестовый бот.<br>Выбери программу, которую ты хочешь выполнить<br>(0, translator, dictionary): 0<br>translator<br><strong>Task:</strong><br>Администрирование базы данных. Установка и настройка базы данных в PostgreSQL.<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ createdb tbase2<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ psql -U tuser -d tbase -h tipubuntu<br>tbase=# GRANT ALL PRIVILEGES ON DATABASE tbase2 to tuser;<br>tbase=# ALTER DATABASE tbase2 OWNER TO tuser;<br>tbase=# \l+<br> tbase&nbsp;&nbsp; | tuser&nbsp;&nbsp;| UTF8&nbsp;&nbsp; | en_US.UTF-8 | en_US.UTF-8 | =Tc/tuser&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+| 9801 kB | pg_default |<br>&nbsp;&nbsp;&nbsp;&nbsp;   |&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | tuser=CTc/tuser&nbsp;&nbsp;   |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br> tbase2&nbsp;&nbsp;| tuser&nbsp;&nbsp;| UTF8&nbsp;&nbsp; | en_US.UTF-8 | en_US.UTF-8 | =Tc/tuser&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+| 8577 kB | pg_default |<br>&nbsp;&nbsp;&nbsp;&nbsp;   |&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | tuser=CTc/tuser&nbsp;&nbsp;   |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>root@kvmubuntu:~# vim /etc/postgresql/14/main/pg_hba.conf<br>root@kvmubuntu:~# cat /etc/postgresql/14/main/pg_hba.conf<br>...<br>host&nbsp;&nbsp;tbase2&nbsp;&nbsp;   tuser&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tipubuntu1/24&nbsp;&nbsp;   md5<br>root@kvmubuntu:~# systemctl restart postgresql<br><strong>Source:</strong><br># https://postgrespro.ru/docs/postgresql/9.5/manage-ag-createdb - Создание базы данных.<br><strong>Task:</strong><br>Разработка базы данных. Разработать схему БД Словарь<br><strong>Decision:</strong><br> <br><br><br><br><br><br><strong>Task:</strong><br>Разработка базы данных.<br>Словарь<br>id | words | translate <br>1 | Текст1 | Text1 <br>2 | Текст2 | Text2  <br>3 | Текст3 | Text3 <br>Термины<br>id | words_id | description | translate<br>1 | 1   | Текст4 | Text4 <br>2 | 3   | Текст5 | Text5 <br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ psql -U tuser -d tbase2 -h tipubuntu<br>tbase2=# CREATE TABLE tbase2 (<br>id INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,<br>words VARCHAR(1000),<br>translate VARCHAR(1000)<br>);<br>tbase2=# CREATE TABLE Terms (<br>id INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,<br>words_id INT,<br>description VARCHAR(1000),<br>translate VARCHAR(1000),<br>CONSTRAINT fk_tbase2<br>  FOREIGN KEY(words_id)<br>  REFERENCES tbase2(id)<br>);<br>tbase2=# INSERT INTO tbase2 (words, translate)<br>VALUES ('Текст1', 'Text1'), ('Текст2', 'Text2'), ('Текст3', 'Text3');<br>tbase2=# INSERT INTO Terms (words_id, description, translate)<br>VALUES (1, 'Текст4', 'Text4'), (3, 'Текст5','Text5');<br><strong>Task:</strong><br>Написание Sql запросов.<br>words | translate | description | translate<br>Текст1 | Text1 | Текст4   | Text4<br>Текст3 | Text3 | Текст5   | Text5<br><strong>Decision:</strong><br>tbase2=# select words, dictionary.translate, description, Terms.translate <br>from dictionary<br>inner join Terms <br>on dictionary.id = Terms.words_id;<br>words | translate | description | translate <br>--------+-----------+-------------+-----------<br>Текст1 | Text1 | Текст4 | Text4<br>Текст3 | Text3 | Текст5 | Text5<br>(2 rows)<br><strong>Source:</strong><br># https://proglib.io/p/rukovodstvo-po-sql-dlya-nachinayushchih-chast-1-sozdanie-bazy-dannyh-tablic-i-ustanovka-svyazey-mezhdu-tablicami-2022-02-07 - Руководство по SQL для начинающих. Часть 1: создание базы данных, таблиц и установка связей между таблицами.<br># https://sql-academy.org/ru/guide/inner-join - Внутреннее соединение INNER JOIN.<br><strong>Task:</strong><br>Администрирование базы данных. Миграция базы с одного сервера на другой.<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ pg_dump -Fc -v --username=tuser --dbname=tbase2 -f datapsql2.dump<br>root@aw:/# scp datapsql2.dump tuser@tipubuntu:/home/tuser/<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ pg_restore -v --no-owner --port=5432 --username=tuser --dbname=tbase2 datapsql2.dump<br><strong>Task:</strong><br>Применение библиотеки Aiogram.<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyTranslatorAiogram.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyTranslatorAiogram.py<br>import logging<br>from translate import Translator<br>from aiogram import Bot, Dispatcher, executor, types<br>API_TOKEN = 'ttoken'<br># Configure logging<br>logging.basicConfig(level=logging.INFO)<br># Initialize bot and dispatcher<br>bot = Bot(token=API_TOKEN)<br>dp = Dispatcher(bot)<br>ru_letters = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя"<br>en_letters = "abcdefghijklmnopqrstuvwxyz"<br>@dp.message_handler(commands=['start', 'help'])<br>async def send_welcome(message: types.Message):<br>await message.reply("Hi!\nI'm EchoBot!\nPowered by aiogram.")<br>@dp.message_handler()<br>async def echo(message: types.Message):<br>text = message.text<br>if text[0].lower() in ru_letters:<br>  translator = Translator(from_lang="russian", to_lang="english")<br>elif text[0].lower() in en_letters:<br>  translator = Translator(from_lang="english", to_lang="russian")<br>else:<br>  await message.answer('Я тебя не понимаю')<br>  return<br>translation = translator.translate(text)<br>await message.answer(translation)<br>if __name__ == '__main__':<br>executor.start_polling(dp, skip_updates=True)<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyTranslatorAiogram.py<br><strong>Source:</strong><br># https://www.youtube.com/@shcoder001 - Переводчик бот в telegram на python за 5 минут aiogram.<br><strong>Task:</strong><br>Применение библиотеки psycopg2.<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyPsql.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyPsql.py<br>import psycopg2<br>try:<br># пытаемся подключиться к базе данных<br>conn = psycopg2.connect(dbname='tbase2', user='tuser', password='tpassword', host='tipubuntu')<br>except:<br># в случае сбоя подключения будет выведено сообщение в STDOUT<br>print('Can`t establish connection to database')<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyPsql.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyPsql.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyPsql.py<br>import psycopg2<br>try:<br># пытаемся подключиться к базе данных<br>conn = psycopg2.connect(dbname='tbase2', user='tuser', password='tpassword', host='tipubuntu')<br>cursor = conn.cursor()<br>cursor.execute('select words, dictionary.translate, description, Terms.translate from dictionary inner join Terms on dictionary.id = Terms.words_id')<br>#records = cursor.fetchall()<br>#print(records)<br>for row in cursor:<br>  print(row)<br>cursor.close()<br>conn.close()<br>except:<br># в случае сбоя подключения будет выведено сообщение в STDOUT<br>print('Can`t establish connection to database')<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyPsql.py<br>('Внутреннее соединение', 'Inner join', 'Возвращаются только те строки, где ключевые значения совпадают в обеих таблицах', 'Only those rows are returned where the key values match in both tables')<br>('Полное соединение', 'Cross Join', 'Позволяет получить декартово произведение нескольких таблиц. особенно полезен, когда между таблицами нет определенной связи, и вам нужно создать полную комбинацию записей из каждой таблицы', '-')<br>('Декартово произведение', 'Cartesian product', 'Результат соединения строки из первой таблицы с каждой строкой из второй таблицы', '-')<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyPsql.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyPsql.py<br>import psycopg2<br>from contextlib import closing<br>with closing(psycopg2.connect(dbname='dictionary', user='tuser', password='tpassword', host='tipubuntu')) as conn:<br>with conn.cursor() as cursor:<br>  cursor.execute('select words, dictionary.translate, description, Terms.translate from dictionary inner join Terms on dictionary.id = Terms.words_id')<br>  for row in cursor:<br>   print(row)<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyPsql.py<br>('Внутреннее соединение', 'Inner join', 'Возвращаются только те строки, где ключевые значения совпадают в обеих таблицах', 'Only those rows are returned where the key values match in both tables')<br>('Полное соединение', 'Cross Join', 'Позволяет получить декартово произведение нескольких таблиц. особенно полезен, когда между таблицами нет определенной связи, и вам нужно создать полную комбинацию записей из каждой таблицы', '-')<br>('Декартово произведение', 'Cartesian product', 'Результат соединения строки из первой таблицы с каждой строкой из второй таблицы', '-')<br><strong>Source:</strong><br># https://ru.hexlet.io/blog/posts/python-postgresql - Использование Psycopg2.<br># https://khashtamov.com/ru/postgresql-python-psycopg2/ - Начало работы.<br><strong>Task:</strong><br>Применение библиотеки Telebot.<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyTranslatorMenuTelebot.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyTranslatorMenuTelebot.py<br>import telebot<br>from telebot import types<br>from googletrans import Translator<br>from langdetect import detect<br>TOKEN='tkey'<br>bot = telebot.TeleBot(TOKEN)<br>translator = Translator()<br>ru_letters = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя"<br>en_letters = "abcdefghijklmnopqrstuvwxyz"<br>@bot.message_handler(commands=["start"])<br>def start(message):<br>&nbsp;&nbsp;message_user = f"Привет, &lt;b&gt;{message.from_user.first_name.title()}&lt;/b&gt;! Я тестовый бот.\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   f"&lt;b&gt;Выбери программу, которую ты хочешь выполнить:&lt;/b&gt;\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   f"1. Чем полезен данный бот\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   f"2. Функции бота (что может данный бот)\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   f"3. Для тех кто хочет поддержать нас и наш проект"<br>&nbsp;&nbsp;markup = types.ReplyKeyboardMarkup(resize_keyboard=True)<br>&nbsp;&nbsp;item1 = types.KeyboardButton(text="Чем полезен бот ?")<br>&nbsp;&nbsp;item2 = types.KeyboardButton(text="Функции бота")<br>&nbsp;&nbsp;item3 = types.KeyboardButton(text="Поддержать проект")<br>&nbsp;&nbsp;markup.add(item1, item2, item3)<br>&nbsp;&nbsp;bot.send_message(message.from_user.id, message_user, reply_markup=markup, parse_mode='html')<br>&nbsp;&nbsp;bot.register_next_step_handler(message, impact_KEYBORD_bot)<br>&nbsp;&nbsp;bot.register_next_step_handler(message, fuctional_KEYBORD_bot)<br>&nbsp;&nbsp;bot.register_next_step_handler(message, donat_user_bot)<br>def impact_KEYBORD_bot(message):<br>&nbsp;&nbsp;if message.text == "Чем полезен бот ?":<br>&nbsp;&nbsp;&nbsp;&nbsp;message_user = "Этот бот много чем будет полезен для вас. Ознакомьтесь с функционалом бота чтобы понять это." \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   " В этого бота со временем мы будем внедрять новые фичи и полезные функции. Чтобы узнавать о новых фишках бота, слидите за нашим Telegramm каналом"<br>&nbsp;&nbsp;&nbsp;&nbsp;key = types.InlineKeyboardMarkup()<br>&nbsp;&nbsp;&nbsp;&nbsp;button = types.InlineKeyboardButton(text='Мое портфолио', url="http://dato138it.ru")<br>&nbsp;&nbsp;&nbsp;&nbsp;key.add(button)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.from_user.id, message_user, reply_markup=key, parse_mode='html')<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, fuctional_KEYBORD_bot)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, donat_user_bot)<br>def fuctional_KEYBORD_bot(message):<br>&nbsp;&nbsp;if message.text == 'Функции бота':<br>&nbsp;&nbsp;&nbsp;&nbsp;message_user = "&lt;b&gt;Добро пожаловать главное меню бота&lt;/b&gt;\n\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   "В скором будущем мы будем добавлять сюда новые функции!"<br>&nbsp;&nbsp;&nbsp;&nbsp;key = types.ReplyKeyboardMarkup(resize_keyboard=True)<br>&nbsp;&nbsp;&nbsp;&nbsp;button0 = types.KeyboardButton("Переводчик")<br>&nbsp;&nbsp;&nbsp;&nbsp;button1 = types.KeyboardButton("Словарь")<br>&nbsp;&nbsp;&nbsp;&nbsp;key.add(button0, button1)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.from_user.id, message_user, reply_markup=key, parse_mode='html')<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, impact_KEYBORD_bot)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, donat_user_bot)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, translate_message)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, dictionary_message)<br>def donat_user_bot(message):<br>&nbsp;&nbsp;if message.text == "Поддержать проект":<br>&nbsp;&nbsp;&nbsp;&nbsp;message_users = f"&lt;b&gt;Приветствую  уважаемый {message.from_user.first_name.title()}&lt;/b&gt;, вы перешли в отдел поддержки нашего проекта \n\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"Мы будем благодарны любой поддержки от вас. И также благодарим, что вы пользуетесь нашим ботом - это главная ваша поддержка для нас!\n\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"Мы принимаем материальную поддержку на:\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"&lt;b&gt;1. Donationalerts&lt;/b&gt;\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"&lt;b&gt;2. PAYEER&lt;/b&gt;\nномер счёта для пополнения: P1091200672\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"&lt;b&gt;3. QIWI&lt;/b&gt;\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"&lt;b&gt;4. Тинькофф банк&lt;/b&gt;"<br>&nbsp;&nbsp;&nbsp;&nbsp;key = types.InlineKeyboardMarkup()<br>&nbsp;&nbsp;&nbsp;&nbsp;button0 = types.InlineKeyboardButton(text="Donationalerts", url="https://www.donationalerts.com/r/tgbot_v")<br>&nbsp;&nbsp;&nbsp;&nbsp;button1 = types.InlineKeyboardButton(text="PAYEER", url="https://payeer.com/ru/account/send/")<br>&nbsp;&nbsp;&nbsp;&nbsp;button2 = types.InlineKeyboardButton(text="QIWI", url="https://my.qiwi.com/VLADYSLAV-DTJ4Y_MwOA")<br>&nbsp;&nbsp;&nbsp;&nbsp;button3 = types.InlineKeyboardButton(text="Тинькофф банк", url="https://www.tinkoff.ru/cf/35TWsWpG8Fe")<br>&nbsp;&nbsp;&nbsp;&nbsp;key.add(button0, button1, button2, button3)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.from_user.id, message_users, reply_markup=key, parse_mode='html')<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, impact_KEYBORD_bot)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, fuctional_KEYBORD_bot)<br>@bot.message_handler(content_types=['text'])<br>def translate_message(message):<br>&nbsp;&nbsp;if message.text == 'Переводчик':<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Напишите сообщения а я переведу его')<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, translate_message_step_2)<br>def translate_message_step_2(message):<br>&nbsp;&nbsp;cmd3 = message.text<br>&nbsp;&nbsp;if cmd3[0].lower() in ru_letters:<br>&nbsp;&nbsp;&nbsp;&nbsp;translation = translator.translate(cmd3, src=detect(cmd3), dest='en').text<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, translation.encode('utf-8', 'replace').decode())<br>&nbsp;&nbsp;elif cmd3[0].lower() in en_letters:<br>&nbsp;&nbsp;&nbsp;&nbsp;translation = translator.translate(cmd3, src=detect(cmd3), dest='ru').text<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, translation.encode('utf-8', 'replace').decode())<br>&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Я тебя не понимаю')<br>def dictionary_message(message):<br>&nbsp;&nbsp;if message.text == 'Словарь':<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'list | term')<br>&nbsp;&nbsp;&nbsp;&nbsp;#text = message.text<br>&nbsp;&nbsp;&nbsp;&nbsp;#bot.send_message("TEST")<br>if __name__ == '__main__':<br>&nbsp;&nbsp;bot.polling(none_stop=True, interval=0)<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyTranslatorMenuTelebot.py<br>- /Start<br>- Привет, David! Я тестовый бот.<br>Выбери программу, которую ты хочешь выполнить:<br>1. Чем полезен данный бот<br>2. Функции бота (что может данный бот)<br>3. Для тех кто хочет поддержать нас и наш проект<br>- Функции бота<br>- Добро пожаловать главное меню бота<br>В скором будущем мы будем добавлять сюда новые функции!<br>1. Переводчик<br>2. Словарь<br>- Переводчик<br>- Напишите сообщения, а я переведу его<br>- Привет, Катя!<br>- Hello, Katya!<br>- Переводчик<br>- Напишите сообщения, а я переведу его<br>- Dear Kate!<br>- Дорогая Кейт!<br><strong>Source:</strong><br># https://www.w3schools.com/python/ref_func_input.asp - Python input() Function.<br># https://proglib.io/p/samouchitel-po-python-dlya-nachinayushchih-chast-10-uslovnyy-cikl-while-2022-12-22 - Управление бесконечным циклом while в Питоне.<br># https://letpy.com/python-guide/functions/ - Функции в Python для начинающих.<br># https://ru.stackoverflow.com/questions/1211592/%D0%9A%D0%B0%D0%BA-%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C-%D0%BC%D0%B5%D0%BD%D1%8E-%D1%81-%D0%B2%D1%8B%D0%B1%D0%BE%D1%80%D0%BE%D0%BC-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B9-%D0%BD%D0%B0-python - Как создать меню с выбором функций на Python?<br># https://ru.stackoverflow.com/questions/1341916/%D0%9A%D0%B0%D0%BA-%D0%B7%D0%B0%D1%86%D0%B8%D0%BA%D0%BB%D0%B8%D1%82%D1%8C-%D0%BC%D0%B5%D0%BD%D1%8E-%D0%B8%D0%BC%D0%B5%D1%8E%D1%89%D0%B5%D0%B5-%D0%BF%D0%BE%D0%B4%D0%BC%D0%B5%D0%BD%D1%8E-%D0%B2-python - Как зациклить меню, имеющее подменю в python?<br># https://docs.python.org/3/tutorial/venv.html - Creating Virtual Environments.<br># https://www.youtube.com/watch?v=A1p7bEtTlxc&t=4s - Как сделать меню для Телеграм Бота на Python.<br><strong>Task:</strong><br>Добавить информацию в базу данных в телеграм бот.<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyPsqlTelebot.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyPsqlTelebot.py<br>import psycopg2<br>import telebot<br>from telebot import types<br>from telebot.types import Message<br>TOKEN='tkey'<br>bot = telebot.TeleBot(TOKEN)<br>DATABASE_URL = "postgres://tuser:tpassword@tipubuntu:5432/tbase2"<br>def connect_to_db():<br>&nbsp;&nbsp;conn = psycopg2.connect(DATABASE_URL, sslmode='require')<br>&nbsp;&nbsp;return conn<br>def insert_data(words, translate):<br>&nbsp;&nbsp;conn = connect_to_db()<br>&nbsp;&nbsp;cursor = conn.cursor()<br>&nbsp;&nbsp;query = "INSERT INTO Dictionary (words, translate) VALUES (%s, %s)"<br>&nbsp;&nbsp;cursor.execute(query, (words, translate))<br>&nbsp;&nbsp;conn.commit()<br>&nbsp;&nbsp;cursor.close()<br>&nbsp;&nbsp;conn.close()<br>@bot.message_handler(commands=['start'])<br>def handle_start(message: Message):<br>&nbsp;&nbsp;words = "Текст4"<br>&nbsp;&nbsp;translate = "Text4"<br>&nbsp;&nbsp;insert_data(words, translate)<br>&nbsp;&nbsp;bot.reply_to(message, "Add Info in Doctionary.")<br>if __name__ == '__main__':<br>&nbsp;&nbsp;bot.polling(none_stop=True, interval=0)<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 pyPsqlTelebot.py<br>- /Start<br>- Add Info in Doctionary.<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ psql -U tuser -d tbase2 -h tipubuntu<br>tbase2=# select * from Dictionary;<br> id |&nbsp;&nbsp;&nbsp;&nbsp; words&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp; translate<br>----+------------------------+-------------------<br>  1 | Внутреннее соединение  | Inner join<br>  2 | Доступ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Available<br>  3 | Полное соединение&nbsp;&nbsp;  | Cross Join<br>  4 | Декартово произведение | Cartesian product<br>  5 | Текст4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Text4<br>(5 rows)<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim .env<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat .env<br>TOKEN='tkey'<br>DB_URL='postgres://tuser:tpassword@tipubuntu:5432/tbase2'<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim requirements.txt<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat requirements.txt<br>translate==3.6.1<br>pyTelegramBotAPI==4.21.0<br>googletrans==3.1.0a0<br>langdetect==1.0.9<br>psycopg2-binary==2.9.9<br>python-dotenv==1.0.1<br>python-decouple==3.8<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim .env<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat .env<br>TOKEN='tkey'<br>DB_URL='postgres://tuser:tpassword@tipubuntu:5432/tbase2'<br><strong>Decision:</strong><br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ vim pyTranslatorMenuTelebotPsql.py<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ cat pyTranslatorMenuTelebotPsql.py<br>import psycopg2<br>import telebot<br>from telebot import types<br>from telebot.types import Message<br>from googletrans import Translator<br>from langdetect import detect<br>from decouple import config<br>from contextlib import closing<br>bot = telebot.TeleBot(config('TOKEN'))<br>translator = Translator()<br>ru_letters = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя"<br>en_letters = "abcdefghijklmnopqrstuvwxyz"<br>DATABASE_URL = config('DB_URL')<br>def connect_to_db():<br>&nbsp;&nbsp;conn = psycopg2.connect(DATABASE_URL, sslmode='require')<br>&nbsp;&nbsp;return conn<br>def insert_dictionary(words, translate):<br>&nbsp;&nbsp;conn = connect_to_db()<br>&nbsp;&nbsp;cursor = conn.cursor()<br>&nbsp;&nbsp;query = "INSERT INTO Dictionary (words, translate) VALUES (%s, %s)"<br>&nbsp;&nbsp;cursor.execute(query, (words, translate))<br>&nbsp;&nbsp;conn.commit()<br>&nbsp;&nbsp;cursor.close()<br>&nbsp;&nbsp;conn.close()<br>def insert_terms(words_id, description, translate):<br>&nbsp;&nbsp;conn = connect_to_db()<br>&nbsp;&nbsp;cursor = conn.cursor()<br>&nbsp;&nbsp;query = "INSERT INTO Terms (words_id, description, translate) VALUES (%s, %s, %s)"<br>&nbsp;&nbsp;cursor.execute(query, (words_id, description, translate))<br>&nbsp;&nbsp;conn.commit()<br>&nbsp;&nbsp;cursor.close()<br>&nbsp;&nbsp;conn.close()<br>@bot.message_handler(commands=['start'])<br>def start(message):<br>&nbsp;&nbsp;message_user = f"Привет, &lt;b&gt;{message.from_user.first_name.title()}&lt;/b&gt;! Я тестовый бот.\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   f"1. Чем полезен бот\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   f"2. Для тех кто хочет поддержать проект"<br>&nbsp;&nbsp;markup = types.ReplyKeyboardMarkup(resize_keyboard=True)<br>&nbsp;&nbsp;but1 = types.KeyboardButton(text="Чем полезен бот ?")<br>&nbsp;&nbsp;but2 = types.KeyboardButton(text="Поддержать проект")<br>&nbsp;&nbsp;markup.add(but1, but2)<br>&nbsp;&nbsp;bot.send_message(message.from_user.id, message_user, reply_markup=markup, parse_mode='html')<br>&nbsp;&nbsp;bot.register_next_step_handler(message, funcs_bot)<br>&nbsp;&nbsp;bot.register_next_step_handler(message, donat_bot)<br>def funcs_bot(message):<br>&nbsp;&nbsp;if message.text == "Чем полезен бот ?":<br>&nbsp;&nbsp;&nbsp;&nbsp;message_user = "Функции бота:\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"1. Переводчик\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"2. Дополнить словарь\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"3. Словарь\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"4. Термины\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"5. Дополнить описание"<br>&nbsp;&nbsp;&nbsp;&nbsp;key = types.ReplyKeyboardMarkup(resize_keyboard=True)<br>&nbsp;&nbsp;&nbsp;&nbsp;#button = types.InlineKeyboardButton(text='Мое портфолио', url="http://dato138it.ru")<br>&nbsp;&nbsp;&nbsp;&nbsp;but1 = types.KeyboardButton("Переводчик")<br>&nbsp;&nbsp;&nbsp;&nbsp;but2 = types.KeyboardButton("Дополнить словарь")<br>&nbsp;&nbsp;&nbsp;&nbsp;but3 = types.KeyboardButton("Словарь")<br>&nbsp;&nbsp;&nbsp;&nbsp;but4 = types.KeyboardButton("Термины")<br>&nbsp;&nbsp;&nbsp;&nbsp;but5 = types.KeyboardButton("Дополнить описание")<br>&nbsp;&nbsp;&nbsp;&nbsp;key.add(but1, but2, but3, but4, but5)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.from_user.id, message_user, reply_markup=key, parse_mode='html')<br>&nbsp;&nbsp;&nbsp;&nbsp;#bot.register_next_step_handler(message, funcs_mess)<br>def donat_bot(message):<br>&nbsp;&nbsp;if message.text == "Поддержать проект":<br>&nbsp;&nbsp;&nbsp;&nbsp;message_users = f"&lt;b&gt;Приветствую, уважаемый {message.from_user.first_name.title()}&lt;/b&gt;, вы перешли в отдел поддержки нашего проекта\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"Мы будем благодарны материальной поддержки от вас на:\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"&lt;b&gt;1. ЮMoney&lt;/b&gt;\n" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"&lt;b&gt;2. Альфа банк&lt;/b&gt;"<br>&nbsp;&nbsp;&nbsp;&nbsp;key = types.InlineKeyboardMarkup()<br>&nbsp;&nbsp;&nbsp;&nbsp;but1 = types.InlineKeyboardButton(text="ЮMoney", url="http://dato138it.ru")<br>&nbsp;&nbsp;&nbsp;&nbsp;but2 = types.InlineKeyboardButton(text="Альфа банк", url="http://dato138it.ru")<br>&nbsp;&nbsp;&nbsp;&nbsp;key.add(but1, but2)<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.from_user.id, message_users, reply_markup=key, parse_mode='html')<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, funcs_bot)<br>@bot.message_handler(content_types=['text'])<br>def funcs_mess(message):<br>&nbsp;&nbsp;if message.text == 'Переводчик':<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Напишите сообщение, которое нужно перевести:')<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, translator_mess)<br>&nbsp;&nbsp;elif message.text == 'Дополнить словарь':<br>&nbsp;&nbsp;&nbsp;&nbsp;if message.from_user.id == int(config('ADMIN_ID')):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Напишите 2 сообщения (предложение и его перевод), которые нужно добавить в словарь:')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, AddDictionary_mess1)<br>&nbsp;&nbsp;&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'У вас нет прав на добавление и удаление предложений из базы')<br>&nbsp;&nbsp;elif message.text == 'Дополнить описание':<br>&nbsp;&nbsp;&nbsp;&nbsp;if message.from_user.id == int(config('ADMIN_ID')):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Напишите 3 сообщения (id - в словаре можно увидеть id, описание и его перевод), которые нужно добавить в словарь:')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bot.register_next_step_handler(message, AddTerms_mess1)<br>&nbsp;&nbsp;&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'У вас нет прав на добавление и удаление предложений из базы')<br>&nbsp;&nbsp;elif message.text == 'Словарь':<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Вывожу список слов:')<br>&nbsp;&nbsp;&nbsp;&nbsp;#bot.register_next_step_handler(message, dictionary_mess)<br>&nbsp;&nbsp;&nbsp;&nbsp;with closing(connect_to_db()) as conn:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with conn.cursor() as cursor:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute('select * from Dictionary;')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for row in cursor:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, "| "+str(row[0])+" | "+row[1]+" | "+row[2]+" |")<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.reply_to(message, "Selected to the dictionary.")<br>&nbsp;&nbsp;elif message.text == 'Термины':<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Вывожу список терминов:')<br>&nbsp;&nbsp;&nbsp;&nbsp;with closing(connect_to_db()) as conn:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with conn.cursor() as cursor:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute('select words, Dictionary.translate, description, Terms.translate from Dictionary inner join Terms on Dictionary.id = Terms.words_id;')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for row in cursor:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, " | "+str(row[0])+" | "+row[1]+" | "+row[2]+" | "+row[3]+" | ")<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.reply_to(message, "Selected to the terms.")<br>&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Я тебя не понимаю')<br>def translator_mess(message):<br>&nbsp;&nbsp;cmd1 = message.text<br>&nbsp;&nbsp;if cmd1[0].lower() in ru_letters:<br>&nbsp;&nbsp;&nbsp;&nbsp;translation = translator.translate(cmd1, src=detect(cmd1), dest='en').text<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, translation.encode('utf-8', 'replace').decode())<br>&nbsp;&nbsp;elif cmd1[0].lower() in en_letters:<br>&nbsp;&nbsp;&nbsp;&nbsp;translation = translator.translate(cmd1, src=detect(cmd1), dest='ru').text<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, translation.encode('utf-8', 'replace').decode())<br>&nbsp;&nbsp;else:<br>&nbsp;&nbsp;&nbsp;&nbsp;bot.send_message(message.chat.id, 'Я тебя не понимаю')<br>def AddDictionary_mess1(message):<br>&nbsp;&nbsp;global cmd2<br>&nbsp;&nbsp;cmd2 = message.text<br>&nbsp;&nbsp;bot.register_next_step_handler(message, AddDictionary_mess2)<br>def AddDictionary_mess2(message):<br>&nbsp;&nbsp;global cmd3<br>&nbsp;&nbsp;cmd3 = message.text<br>&nbsp;&nbsp;insert_dictionary(cmd2, cmd3)<br>&nbsp;&nbsp;bot.reply_to(message, "Info added to the dictionary.")<br>def AddTerms_mess1(message):<br>&nbsp;&nbsp;global cmd4<br>&nbsp;&nbsp;cmd4 = message.text<br>&nbsp;&nbsp;bot.register_next_step_handler(message, AddTerms_mess2)<br>def AddTerms_mess2(message):<br>&nbsp;&nbsp;global cmd5<br>&nbsp;&nbsp;cmd5 = message.text<br>&nbsp;&nbsp;bot.register_next_step_handler(message, AddTerms_mess3)<br>def AddTerms_mess3(message):<br>&nbsp;&nbsp;global cmd6<br>&nbsp;&nbsp;cmd6 = message.text<br>&nbsp;&nbsp;insert_terms(cmd4, cmd5, cmd6)<br>&nbsp;&nbsp;bot.reply_to(message, "Info added to the terms.")<br>if __name__ == '__main__':<br>&nbsp;&nbsp;bot.polling(none_stop=True, interval=0)<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ python3 py.py<br>- Чем полезен бот ?<br>- Функции бота:<br>1. Переводчик<br>2. Дополнить словарь<br>- Дополнить словарь<br>- Напишите 2 сообщения (предложение и его перевод), которые нужно добавить в словарь:<br>- new<br>новый<br>- Info added to the dictionary.<br>- Словарь<br>- Вывожу словарь:<br>| Inner join | Возвращаются только те строки, где ключевые значения совпадают в обеих таблицах | Only those rows are returned where the key values match in both tables |<br>| Cross Join | Позволяет получить декартово произведение нескольких таблиц. особенно полезен, когда между таблицами нет определенной связи, и вам нужно создать полную комбинацию записей из каждой таблицы | - |<br>| Cartesian product | Результат соединения строки из первой таблицы с каждой строкой из второй таблицы | - |<br>Selected to the dictionary.<br>(tenv) tuser@kvmubuntu:~/TelegramBotTranslator$ psql -U tuser -d tbase2 -h tipubuntu<br>tbase2=# select * from Dictionary;<br>...<br> 49 | new | новый<br>tbase2=# TRUNCATE Terms, Dictionary CASCADE;<br><strong>Source:</strong><br># https://stackoverflow.com/questions/75900203/how-do-i-connect-my-telegram-bot-telebot-to-postgresql-url - How do I connect my telegram bot (telebot) to PostgreSQL url.<br># https://pythonru.com/osnovy/globalnye-peremennye-python - Правила использования global.<br># https://ru.stackoverflow.com/questions/1103332/Авторизация-в-телеграмм-боте-на-python - Авторизация в телеграмм боте на Python.<br># https://otvet.mail.ru/question/219454196 - Python. Telegram bot api Как из Username получить user_id.<br># https://stackoverflow.com/questions/13223820/postgresql-delete-all-content - PostgreSQL удаляет все содержимое.<br><strong>Task:</strong><br>Настройка службы бота.<br><strong>Decision:</strong><br>root@kvmubuntu:~# vim /etc/systemd/system/dato38itbot.service<br>root@kvmubuntu:~# cat /etc/systemd/system/dato38itbot.service<br>[Unit]<br>Description=Telegram dato38it-bot<br>After=network.target<br>[Service]<br>User=tuser<br>Group=tuser<br>WorkingDirectory=/home/tuser/dato38itbot/<br>VIRTUAL_ENV=/home/tuser/dato38itbot/telegaenv<br>Environment=PATH=$VIRTUAL_ENV/bin:$PATH<br>ExecStart=/home/tuser/dato38itbot/telegaenv/bin/python /home/tuser/dato38itbot/main.py<br>Restart=on-failure<br>[Install]<br>WantedBy=multi-user.target<br>root@kvmubuntu:~# systemctl daemon-reload<br>root@kvmubuntu:~# systemctl enable dato38itbot.service<br>root@kvmubuntu:~# systemctl start dato38itbot.service<br>root@kvmubuntu:~# systemctl status dato38itbot.service<br><strong>Source:</strong><br># https://thecode.media/systemctl/ - Готовим файл для работы службы.<br># https://synay.net/vps/preconfigured/own-telegram-bot-server-debian-12 - Создадим файл службы, чтобы запускать бот автоматически.<br># https://gist.github.com/ricferr/90583f608f0b0ae9c3cf6833be04ab85 - How to create a systemd service for python script with virtualenv.</p>